<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Universal File Converter - 21K Tools</title>
  <style>
    * {
      margin: 0; 
      padding: 0; 
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      background-attachment: fixed;
      min-height: 100vh;
      color: #1a1a1a;
    }

    .header {
      background: white;
      box-shadow: 0 4px 20px rgba(30, 64, 175, 0.3);
      position: sticky; 
      top: 0; 
      z-index: 1000;
    }
    
    .header-container {
      max-width: 1200px; 
      margin: 0 auto; 
      padding: 0 20px;
    }
    
    .logo-container {
      display: flex;
      justify-content: center;
      padding: 15px 0;
    }
    
    .logo {
      display: flex;
      align-items: center;
      font-size: 28px;
      font-weight: 800;
      text-decoration: none;
      color: #2563eb;
      gap:8px;
      transition: transform 0.3s ease;
    }
    
    .logo:hover {
      transform: scale(1.05);
    }
    
    .logo-icon {
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, #3b82f6, #1d4ed8);
      border-radius: 102px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: white;
      box-shadow: 0 4px 20px rgba(59, 130, 246, 0.3);
    }

    .header-actions-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 0px 10px;
      gap: 10px;
    }
    
    .search-box {
      position: relative; 
      flex-grow: 1;
      max-width: 700px;
      width:100%;
      margin: 0 auto;
    }
    
    .search-input {
      width: 100%;
      background: rgba(255, 255, 255, 0.8);
      border: 2px solid rgba(59, 130, 246, 0.2);
      border-radius: 30px;
      padding: 12px 50px 12px 20px;
      font-size: 15px;
      transition: all 0.3s ease;
    }
    
    .search-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.95);
      border-color: #3b82f6;
      box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
    }
    
    .search-btn {
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      background: linear-gradient(135deg, #3b82f6, #1d4ed8);
      border: none;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      color: white;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s ease;
    }
    
    .search-btn:hover {
      transform: translateY(-50%) scale(1.1);
      box-shadow: 0 4px 20px rgba(59, 130, 246, 0.4);
    }
    
    .mobileToggle {
      cursor: pointer;
      padding: 10px;
    }
    
    .bar1, .bar2, .bar3 {
      width: 23px; 
      height: 2px; 
      background-color: #1e3a8a;
      margin: 6px 0; 
      transition: 0.4s;
    }
    
    .change .bar1 { transform: translate(0, 8px) rotate(-45deg); }
    .change .bar2 { opacity: 0; }
    .change .bar3 { transform: translate(0, -8px) rotate(45deg); }

    .nav-menu {
      display: flex; 
      gap: 10px; 
      margin-top: 15px; 
      padding-bottom: 15px;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .nav-link {
      color: #1e40af;
      padding: 8px 15px;
      border-radius: 20px;
      transition: all 0.3s ease;
      text-decoration: none;
      font-weight: 500;
    }
    
    .nav-link:hover, .nav-link.active {
      background: rgba(59, 130, 246, 0.2);
      color: #1e40af;
    }

    .mobile-panel {
      display: none; 
      flex-direction: column; 
      gap: 15px;
      background: white; 
      padding: 20px; 
      position: absolute;
      top: 100%; 
      left: 0; 
      width: 100%;
      animation: slideDown 0.4s ease-in-out;
      z-index: 999;
      box-shadow: 0 10px 15px rgba(0,0,0,0.1);
    }
    
    .mobile-panel.show { display: flex; }

    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .main-content {
      flex: 1; 
      padding: 40px 20px; 
      max-width: 1200px;
      margin: 0 auto; 
      text-align: center;
    }

    .converter-section {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 24px;
      padding: 40px;
      margin: 20px 0;
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
    }

    .converter-title {
      font-size: 2.5rem;
      font-weight: 800;
      color: #1a1a1a;
      margin-bottom: 15px;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .converter-subtitle {
      font-size: 1.2rem;
      color: #64748b;
      margin-bottom: 40px;
      line-height: 1.6;
    }

    .upload-area {
      border: 3px dashed #3b82f6;
      border-radius: 20px;
      padding: 60px 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      background: rgba(59, 130, 246, 0.05);
      margin-bottom: 30px;
      position: relative;
    }

    .upload-area:hover {
      border-color: #1d4ed8;
      background: rgba(59, 130, 246, 0.1);
      transform: translateY(-2px);
    }

    .upload-area.dragover {
      border-color: #10b981;
      background: rgba(16, 185, 129, 0.1);
      transform: scale(1.02);
    }

    .upload-icon {
      font-size: 4rem;
      color: #3b82f6;
      margin-bottom: 20px;
    }

    .upload-text {
      font-size: 1.3rem;
      font-weight: 600;
      color: #1a1a1a;
      margin-bottom: 10px;
    }

    .upload-subtext {
      color: #64748b;
      font-size: 14px;
    }

    .file-input {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
    }

    .conversion-options {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin-bottom: 30px;
    }

    .format-section {
      display: flex;
      align-items: center;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .format-selector {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .format-label {
      font-weight: 600;
      color: #1a1a1a;
      font-size: 16px;
    }

    .format-select {
      padding: 12px 20px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      font-size: 14px;
      font-weight: 500;
      background: white;
      cursor: pointer;
      transition: all 0.3s ease;
      min-width: 120px;
    }

    .format-select:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
    }

    .arrow-icon {
      font-size: 24px;
      color: #3b82f6;
    }

    .convert-button {
      background: linear-gradient(135deg, #3b82f6, #1d4ed8);
      color: white;
      border: none;
      padding: 16px 40px;
      border-radius: 50px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 8px 30px rgba(59, 130, 246, 0.3);
      position: relative;
      overflow: hidden;
    }

    .convert-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 15px 50px rgba(59, 130, 246, 0.4);
    }

    .convert-button:disabled {
      background: #9ca3af;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .progress-bar {
      width: 100%;
      height: 6px;
      background: #e5e7eb;
      border-radius: 3px;
      overflow: hidden;
      margin: 20px 0;
      display: none;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #3b82f6, #10b981);
      border-radius: 3px;
      transition: width 0.3s ease;
      width: 0%;
    }

    .file-info {
      display: none;
      background: rgba(59, 130, 246, 0.1);
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      text-align: left;
    }

    .file-info.show {
      display: block;
    }

    .file-name {
      font-weight: 600;
      color: #1a1a1a;
      margin-bottom: 5px;
    }

    .file-size {
      color: #64748b;
      font-size: 14px;
    }

    .supported-formats {
      margin-top: 40px;
      padding-top: 40px;
      border-top: 1px solid #e5e7eb;
    }

    .formats-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: #1a1a1a;
      margin-bottom: 20px;
    }

    .formats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .format-category {
      background: rgba(255, 255, 255, 0.8);
      border-radius: 12px;
      padding: 20px;
      text-align: left;
    }

    .category-title {
      font-weight: 600;
      color: #1a1a1a;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .category-formats {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .format-badge {
      background: rgba(59, 130, 246, 0.1);
      color: #2563eb;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
    }

    .batch-section {
      margin-top: 30px;
      padding-top: 30px;
      border-top: 1px solid #e5e7eb;
    }

    .batch-title {
      font-size: 1.3rem;
      font-weight: 600;
      color: #1a1a1a;
      margin-bottom: 15px;
    }

    .batch-upload {
      border: 2px dashed #10b981;
      border-radius: 12px;
      padding: 30px;
      background: rgba(16, 185, 129, 0.05);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .batch-upload:hover {
      background: rgba(16, 185, 129, 0.1);
      border-color: #059669;
    }

    .download-section {
      display: none;
      margin-top: 30px;
      padding: 30px;
      background: rgba(16, 185, 129, 0.1);
      border-radius: 12px;
      border: 1px solid rgba(16, 185, 129, 0.2);
    }

    .download-section.show {
      display: block;
    }

    .download-title {
      font-size: 1.3rem;
      font-weight: 600;
      color: #065f46;
      margin-bottom: 15px;
    }

    .download-button {
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
      border: none;
      padding: 14px 30px;
      border-radius: 30px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }

    .download-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);
    }

    .footer {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
      color: white; 
      margin-top: 60px;
    }
    
    .footer-container {
      max-width: 1200px; 
      margin: 0 auto; 
      padding: 50px 20px 20px;
    }
    
    .footer-content {
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 40px; 
      margin-bottom: 40px;
    }
    
    .footer-section h3 {
      color: #60a5fa; 
      font-size: 18px; 
      font-weight: 600; 
      margin-bottom: 20px;
    }
    
    .footer-links {
      list-style: none;
    }
    
    .footer-links li {
      margin-bottom: 10px;
    }
    
    .footer-links a {
      color: rgba(255, 255, 255, 0.8); 
      text-decoration: none; 
      transition: color 0.3s ease;
    }
    
    .footer-links a:hover { 
      color: #60a5fa; 
    }

    .footer-bottom {
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      padding: 20px 0; 
      display: flex; 
      justify-content: space-between;
      align-items: center; 
      flex-wrap: wrap; 
      gap: 15px;
    }
    
    .footer-brand {
      display: flex; 
      align-items: center; 
      gap: 10px;
    }
    
    .footer-brand-icon {
      width: 38px; 
      height: 38px; 
      background: #3b82f6;
      border-radius: 20px; 
      display: flex; 
      align-items: center;
      justify-content: center; 
      font-weight: bold;
    }
    
    .social-links {
      display: flex; 
      gap: 15px;
    }
    
    .social-link {
      width: 40px; 
      height: 40px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%; 
      display: flex;
      align-items: center; 
      justify-content: center;
      color: white; 
      text-decoration: none;
      transition: all 0.3s ease;
    }
    
    .social-link:hover {
      background: #3b82f6; 
      transform: translateY(-2px);
    }

    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 20px;
      border-radius: 12px;
      color: white;
      font-weight: 500;
      z-index: 10000;
      transform: translateX(400px);
      transition: transform 0.3s ease;
    }

    .notification.show {
      transform: translateX(0);
    }

    .notification.success {
      background: linear-gradient(135deg, #10b981, #059669);
    }

    .notification.error {
      background: linear-gradient(135deg, #ef4444, #dc2626);
    }

    .csrf-token {
      display: none;
    }

    @media (max-width: 768px) {
      .nav-menu { 
        display: none; 
      }
      
      .mobileToggle {
        display: block;
      }
      
      .converter-title { 
        font-size: 2rem; 
      }
      
      .format-section {
        flex-direction: column;
        gap: 15px;
      }
      
      .arrow-icon {
        transform: rotate(90deg);
      }
      
      .footer-bottom { 
        flex-direction: column; 
        text-align: center; 
      }
      
      .footer-content {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 30px;
      }
    }

    @media (max-width: 480px) {
      .header-container, .footer-container {
        padding-left: 15px; 
        padding-right: 15px;
      }
      
      .converter-section {
        padding: 20px;
      }
      
      .upload-area {
        padding: 40px 15px;
      }
    }
  </style>
</head>
<body>

<header class="header">
  <div class="header-container">
    <div class="logo-container">
      <a href="/" class="logo">
        <div class="logo-icon">21K</div>
        <span>Tools</span>
      </a>
    </div>
    
    <div class="header-actions-container">
      <div class="search-box">
        <input type="text" class="search-input" placeholder="Search tools...">
        <button class="search-btn">üîç</button>
      </div>
      <div class="mobileToggle" id="mobileToggle">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
      </div>
    </div>
    
    <nav class="header-nav">
      <div class="nav-menu">
        <a href="https://21k.tools" class="nav-link">üè† Home</a>
        <a href="https://video.21k.tools" class="nav-link">üé• Video Tools</a>
        <a href="https://image.21k.tools" class="nav-link">üñºÔ∏è Image Tools</a>
        <a href="https://pdf.21k.tools" class="nav-link">üìÑ PDF Tools</a>
        <a href="https://audio.21k.tools" class="nav-link">üéµ Audio Tools</a>
        <a href="https://text.21k.tools" class="nav-link">üìù Text Tools</a>
        <a href="https://dev.21k.tools" class="nav-link">üíª Dev Tools</a>
      </div>
    </nav>
    
    <div class="mobile-panel" id="mobilePanel">
      <a href="https://21k.tools" class="nav-link">üè† Home</a>
      <a href="https://video.21k.tools" class="nav-link">üé• Video Tools</a>
      <a href="https://image.21k.tools" class="nav-link">üñºÔ∏è Image Tools</a>
      <a href="https://pdf.21k.tools" class="nav-link">üìÑ PDF Tools</a>
      <a href="https://audio.21k.tools" class="nav-link">üéµ Audio Tools</a>
      <a href="https://text.21k.tools" class="nav-link">üìù Text Tools</a>
      <a href="https://dev.21k.tools" class="nav-link">üíª Dev Tools</a>
    </div>
  </div>
</header>

<main class="main-content">
  <div class="converter-section">
    <h1 class="converter-title">üîÑ Universal File Converter</h1>
    <p class="converter-subtitle">Convert any file format to any other format instantly. Support for 100+ file types including documents, images, audio, video, and more.</p>
    
    <form id="converterForm" enctype="multipart/form-data">
      <input type="hidden" name="csrfmiddlewaretoken" value="" class="csrf-token">
      <div class="upload-area" id="uploadArea">
        <div class="upload-icon">üìÅ</div>
        <div class="upload-text">Drop your file here or click to browse</div>
        <div class="upload-subtext">Supports all major file formats ‚Ä¢ Max size: 100MB</div>
        <input type="file" class="file-input" id="fileInput" name="file" accept="*/*">
      </div>
      
      <div class="file-info" id="fileInfo">
        <div class="file-name" id="fileName"></div>
        <div class="file-size" id="fileSize"></div>
      </div>
      
      <div class="conversion-options">
        <div class="format-section">
          <div class="format-selector">
            <label class="format-label">From:</label>
            <select class="format-select" id="fromFormat" disabled>
              <option value="">Auto-detect</option>
            </select>
          </div>
          
          <div class="arrow-icon">‚Üí</div>
          
          <div class="format-selector">
            <label class="format-label">To:</label>
            <select class="format-select" id="toFormat" name="target_format" required>
              <option value="">Select format</option>
            </select>
          </div>
        </div>
        
        <button type="submit" class="convert-button" id="convertBtn" disabled>
          <span id="convertText">Convert File</span>
        </button>
      </div>
      
      <div class="progress-bar" id="progressBar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
    </form>
    
    <div class="download-section" id="downloadSection">
      <div class="download-title">‚úÖ Conversion Complete!</div>
      <p style="margin-bottom: 15px;">Your file has been successfully converted.</p>
      <a href="#" class="download-button" id="downloadBtn">Download Converted File</a>
    </div>
    
    <div class="batch-section">
      <div class="batch-title">üì¶ Batch Conversion</div>
      <div class="batch-upload" id="batchUpload">
        <div style="text-align: center;">
          <div style="font-size: 2rem; margin-bottom: 10px;">üìö</div>
          <div style="font-weight: 600;">Convert Multiple Files</div>
          <div style="font-size: 14px; color: #64748b;">Select multiple files to convert them all at once</div>
          <input type="file" multiple style="display: none;" id="batchInput">
        </div>
      </div>
    </div>
    
    <div class="supported-formats">
      <h3 class="formats-title">üéØ Supported Formats</h3>
      <div class="formats-grid">
        <div class="format-category">
          <div class="category-title">üì∑ Images</div>
          <div class="category-formats">
            <span class="format-badge">JPG</span>
            <span class="format-badge">PNG</span>
            <span class="format-badge">GIF</span>
            <span class="format-badge">BMP</span>
            <span class="format-badge">TIFF</span>
            <span class="format-badge">WebP</span>
            <span class="format-badge">SVG</span>
            <span class="format-badge">ICO</span>
          </div>
        </div>
        
        <div class="format-category">
          <div class="category-title">üìÑ Documents</div>
          <div class="category-formats">
            <span class="format-badge">PDF</span>
            <span class="format-badge">DOCX</span>
            <span class="format-badge">DOC</span>
            <span class="format-badge">TXT</span>
            <span class="format-badge">RTF</span>
            <span class="format-badge">HTML</span>
            <span class="format-badge">MD</span>
            <span class="format-badge">CSV</span>
            <span class="format-badge">XLSX</span>
          </div>
        </div>
        
        <div class="format-category">
          <div class="category-title">üéµ Audio</div>
          <div class="category-formats">
            <span class="format-badge">MP3</span>
            <span class="format-badge">WAV</span>
            <span class="format-badge">FLAC</span>
            <span class="format-badge">AAC</span>
            <span class="format-badge">OGG</span>
            <span class="format-badge">M4A</span>
            <span class="format-badge">WMA</span>
            <span class="format-badge">AIFF</span>
          </div>
        </div>
        
        <div class="format-category">
          <div class="category-title">üé• Video</div>
          <div class="category-formats">
            <span class="format-badge">MP4</span>
            <span class="format-badge">AVI</span>
            <span class="format-badge">MOV</span>
            <span class="format-badge">WMV</span>
            <span class="format-badge">FLV</span>
            <span class="format-badge">WebM</span>
            <span class="format-badge">MKV</span>
            <span class="format-badge">3GP</span>
          </div>
        </div>
        
        <div class="format-category">
          <div class="category-title">üóÉÔ∏è Archives</div>
          <div class="category-formats">
            <span class="format-badge">ZIP</span>
            <span class="format-badge">RAR</span>
            <span class="format-badge">7Z</span>
            <span class="format-badge">TAR</span>
            <span class="format-badge">GZ</span>
            <span class="format-badge">BZ2</span>
          </div>
        </div>
        
        <div class="format-category">
          <div class="category-title">üíæ Data</div>
          <div class="category-formats">
            <span class="format-badge">JSON</span>
            <span class="format-badge">XML</span>
            <span class="format-badge">YAML</span>
            <span class="format-badge">CSV</span>
            <span class="format-badge">SQL</span>
            <span class="format-badge">XLSX</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<footer class="footer">
  <div class="footer-container">
    <div class="footer-content">
      <div class="footer-section">
        <h3>Popular Tools</h3>
        <ul class="footer-links">
          <li><a href="https://video.21k.tools/downloader">Video Downloader</a></li>
          <li><a href="https://image.21k.tools/resize">Image Resizer</a></li>
          <li><a href="https://pdf.21k.tools/merge">PDF Merger</a></li>
          <li><a href="https://audio.21k.tools/converter">Audio Converter</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h3>Categories</h3>
        <ul class="footer-links">
          <li><a href="https://video.21k.tools">Video Tools</a></li>
          <li><a href="https://image.21k.tools">Image Tools</a></li>
          <li><a href="https://pdf.21k.tools">PDF Tools</a></li>
          <li><a href="https://audio.21k.tools">Audio Tools</a></li>
          <li><a href="https://text.21k.tools">Text Tools</a></li>
          <li><a href="https://dev.21k.tools">Developer Tools</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h3>Support</h3>
        <ul class="footer-links">
          <li><a href="/help">Help Center</a></li>
          <li><a href="/contact">Contact Us</a></li>
          <li><a href="/api">API Documentation</a></li>
          <li><a href="/status">Server Status</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h3>Company</h3>
        <ul class="footer-links">
          <li><a href="/about">About Us</a></li>
          <li><a href="/privacy">Privacy Policy</a></li>
          <li><a href="/terms">Terms of Service</a></li>
          <li><a href="/blog">Blog</a></li>
        </ul>
      </div>
    </div>
    <div class="footer-bottom">
      <div class="footer-brand">
        <div class="footer-brand-icon">21K</div>
        <span>&copy; 2025 21K Tools. All rights reserved.</span>
      </div>
      <div class="social-links">
        <a href="#" class="social-link" title="Twitter">üê¶</a>
        <a href="#" class="social-link" title="Facebook">üìò</a>
        <a href="#" class="social-link" title="LinkedIn">üíº</a>
        <a href="#" class="social-link" title="GitHub">üêô</a>
      </div>
    </div>
  </div>
</footer>

<div class="notification" id="notification"></div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  // Get CSRF token from cookie
  function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
      const cookies = document.cookie.split(';');
      for (let i = 0; i < cookies.length; i++) {
        const cookie = cookies[i].trim();
        if (cookie.substring(0, name.length + 1) === (name + '=')) {
          cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
          break;
        }
      }
    }
    return cookieValue;
  }
  
  const csrftoken = getCookie('csrftoken');
  document.querySelector('.csrf-token').value = csrftoken;
  
  // Mobile menu toggle
  const mobileToggle = document.getElementById('mobileToggle');
  const mobilePanel = document.getElementById('mobilePanel');
  
  mobileToggle.addEventListener('click', (e) => {
    e.stopPropagation();
    mobileToggle.classList.toggle('change');
    mobilePanel.classList.toggle('show');
  });
  
  document.addEventListener('click', () => {
    mobileToggle.classList.remove('change');
    mobilePanel.classList.remove('show');
  });
  
  mobilePanel.addEventListener('click', (e) => {
    e.stopPropagation();
  });
  
  // File upload handling
  const uploadArea = document.getElementById('uploadArea');
  const fileInput = document.getElementById('fileInput');
  const fileInfo = document.getElementById('fileInfo');
  const fileName = document.getElementById('fileName');
  const fileSize = document.getElementById('fileSize');
  const fromFormat = document.getElementById('fromFormat');
  const toFormat = document.getElementById('toFormat');
  const convertBtn = document.getElementById('convertBtn');
  const progressBar = document.getElementById('progressBar');
  const progressFill = document.getElementById('progressFill');
  const downloadSection = document.getElementById('downloadSection');
  const downloadBtn = document.getElementById('downloadBtn');
  const batchUpload = document.getElementById('batchUpload');
  const batchInput = document.getElementById('batchInput');
  const notification = document.getElementById('notification');

  // Supported formats
  const supportedFormats = {
    image: ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'tiff', 'webp', 'svg', 'ico', 'raw'],
    document: ['pdf', 'docx', 'doc', 'txt', 'rtf', 'odt', 'html', 'md', 'csv', 'xlsx', 'xls'],
    audio: ['mp3', 'wav', 'flac', 'aac', 'ogg', 'm4a', 'wma', 'aiff'],
    video: ['mp4', 'avi', 'mov', 'wmv', 'flv', 'webm', 'mkv', '3gp', 'mpg', 'mpeg'],
    archive: ['zip', 'rar', '7z', 'tar', 'gz', 'bz2'],
    data: ['json', 'xml', 'yaml', 'csv', 'xlsx', 'sql']
  };

  // Populate format selectors
  function populateFormatSelectors() {
    // Clear existing options
    toFormat.innerHTML = '<option value="">Select format</option>';
    
    // Get all unique formats
    const allFormats = new Set();
    Object.values(supportedFormats).forEach(category => {
      category.forEach(format => allFormats.add(format));
    });
    
    // Add options to toFormat
    Array.from(allFormats).sort().forEach(format => {
      const option = document.createElement('option');
      option.value = format;
      option.textContent = format.toUpperCase();
      toFormat.appendChild(option);
    });
  }

  // Show notification
  function showNotification(message, isSuccess = true) {
    notification.textContent = message;
    notification.className = `notification ${isSuccess ? 'success' : 'error'}`;
    notification.classList.add('show');
    
    setTimeout(() => {
      notification.classList.remove('show');
    }, 5000);
  }

  // Handle file selection
  function handleFileSelect(file) {
    if (!file) return;
    
    const fileExt = file.name.split('.').pop().toLowerCase();
    const fileSizeMB = (file.size / (1024 * 1024)).toFixed(2);
    
    // Update file info
    fileName.textContent = file.name;
    fileSize.textContent = `${fileSizeMB} MB`;
    fileInfo.classList.add('show');
    
    // Update from format
    fromFormat.innerHTML = `<option value="${fileExt}">${fileExt.toUpperCase()}</option>`;
    
    // Enable convert button when target format is selected
    toFormat.addEventListener('change', function() {
      convertBtn.disabled = !this.value;
    });
    
    // Enable convert button
    convertBtn.disabled = false;
  }

  // Handle drag and drop
  uploadArea.addEventListener('dragover', (e) => {
    e.preventDefault();
    uploadArea.classList.add('dragover');
  });

  uploadArea.addEventListener('dragleave', () => {
    uploadArea.classList.remove('dragover');
  });

  uploadArea.addEventListener('drop', (e) => {
    e.preventDefault();
    uploadArea.classList.remove('dragover');
    
    if (e.dataTransfer.files.length) {
      fileInput.files = e.dataTransfer.files;
      handleFileSelect(e.dataTransfer.files[0]);
    }
  });

  fileInput.addEventListener('change', () => {
    if (fileInput.files.length) {
      handleFileSelect(fileInput.files[0]);
    }
  });

  // Handle batch upload
  batchUpload.addEventListener('click', () => {
    batchInput.click();
  });

  batchInput.addEventListener('change', () => {
    if (batchInput.files.length > 0) {
      showNotification(`Selected ${batchInput.files.length} files for batch conversion`, true);
      // Here you would typically handle the batch upload to the server
    }
  });

  // Handle form submission
  document.getElementById('converterForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    if (!fileInput.files.length || !toFormat.value) {
      showNotification('Please select a file and target format', false);
      return;
    }
    
    const formData = new FormData();
    formData.append('file', fileInput.files[0]);
    formData.append('target_format', toFormat.value);
    formData.append('csrfmiddlewaretoken', csrftoken);
    
    try {
      // Show progress
      progressBar.style.display = 'block';
      convertBtn.disabled = true;
      document.getElementById('convertText').textContent = 'Converting...';
      
      // Simulate progress (in a real app, you'd use actual upload progress)
      let progress = 0;
      const progressInterval = setInterval(() => {
        progress += 5;
        progressFill.style.width = `${Math.min(progress, 90)}%`;
        if (progress >= 90) clearInterval(progressInterval);
      }, 200);
      
      // Send to server
      const response = await fetch('/convert/', {
        method: 'POST',
        headers: {
          'X-CSRFToken': csrftoken
        },
        body: formData
      });
      
      clearInterval(progressInterval);
      progressFill.style.width = '100%';
      
      if (!response.ok) {
        throw new Error('Conversion failed');
      }
      
      const result = await response.json();
      
      if (result.success) {
        // Show download section
        downloadSection.classList.add('show');
        downloadBtn.href = result.download_url;
        downloadBtn.download = result.converted_name;
        
        showNotification('File converted successfully!', true);
      } else {
        throw new Error(result.error || 'Conversion failed');
      }
    } catch (error) {
      showNotification(error.message, false);
      console.error('Conversion error:', error);
    } finally {
      convertBtn.disabled = false;
      document.getElementById('convertText').textContent = 'Convert File';
    }
  });

  // Initialize
  populateFormatSelectors();
});
</script>

</body>
</html>